#!/bin/sh

xmldbc -P /etc/services/WIFI/rtcfg.php -V ACTION="INIT" > /var/init_wifi_mod.sh

# set initial arguments for module 4331 (it has no srom values)
# more detail to check bcm94708_alpha_wrgac02.txt in bootcode
for slotidx in 0 1
do
nvram set pci/1/$slotidx/vendid=0x14E4
nvram set pci/1/$slotidx/maxp2ga0=0x56
nvram set pci/1/$slotidx/maxp2ga1=0x56
nvram set pci/1/$slotidx/maxp2ga2=0x56
nvram set pci/1/$slotidx/cckbw202gpo=0x0000
nvram set pci/1/$slotidx/cckbw20ul2gpo=0x0000
nvram set pci/1/$slotidx/legofdmbw202gpo=0x00000000
nvram set pci/1/$slotidx/legofdmbw20ul2gpo=0x00000000
nvram set pci/1/$slotidx/mcsbw202gpo=0x00000000
nvram set pci/1/$slotidx/mcsbw20ul2gpo=0x00000000
nvram set pci/1/$slotidx/mcsbw402gpo=0x22222222
nvram set pci/1/$slotidx/pa2gw0a0=0xFE7C
nvram set pci/1/$slotidx/pa2gw1a0=0x1C9B
nvram set pci/1/$slotidx/pa2gw2a0=0xF915
nvram set pci/1/$slotidx/pa2gw0a1=0xFE85
nvram set pci/1/$slotidx/pa2gw1a1=0x1D25
nvram set pci/1/$slotidx/pa2gw2a1=0xF906
nvram set pci/1/$slotidx/pa2gw0a2=0xFE82
nvram set pci/1/$slotidx/pa2gw1a2=0x1D45
nvram set pci/1/$slotidx/pa2gw2a2=0xF900
done

# 5G
# set initial arguments for module 4360b (it has no srom values)
for slotidx in 0 1
do
nvram set pci/2/$slotidx/sromrev=11
nvram set pci/2/$slotidx/venid=0x14E4
nvram set pci/2/$slotidx/vendid=0x14E4
nvram set pci/2/$slotidx/boardvendor=0x14E4
nvram set pci/2/$slotidx/devid=0x43a2
#nvram set pci/2/$slotidx/boardrev=0x1307
nvram set pci/2/$slotidx/boardrev=0x1450
#nvram set pci/2/$slotidx/boardflags=0x10000000
nvram set pci/2/$slotidx/boardflags=0x30000000
nvram set pci/2/$slotidx/boardflags2=0x300002
nvram set pci/2/$slotidx/boardtype=0x621
#nvram set pci/2/$slotidx/boardflags3=0x300030
nvram set pci/2/$slotidx/boardflags3=0x0
nvram set pci/2/$slotidx/boardnum=0
nvram set pci/2/$slotidx/macaddr=00:90:4c:d4:00:00
#nvram set pci/2/$slotidx/ccode=Q1
nvram set pci/2/$slotidx/ccode=20785
nvram set pci/2/$slotidx/regrev=27
nvram set pci/2/$slotidx/aa2g=0
nvram set pci/2/$slotidx/aa5g=7
nvram set pci/2/$slotidx/agbg0=71
nvram set pci/2/$slotidx/agbg1=71
nvram set pci/2/$slotidx/agbg2=133
nvram set pci/2/$slotidx/aga0=71
nvram set pci/2/$slotidx/aga1=133
nvram set pci/2/$slotidx/aga2=133
nvram set pci/2/$slotidx/txchain=7
nvram set pci/2/$slotidx/rxchain=7
nvram set pci/2/$slotidx/antswitch=0
nvram set pci/2/$slotidx/tssiposslope2g=1
nvram set pci/2/$slotidx/epagain2g=0
nvram set pci/2/$slotidx/pdgain2g=4
nvram set pci/2/$slotidx/tworangetssi2g=0
nvram set pci/2/$slotidx/papdcap2g=0
nvram set pci/2/$slotidx/femctrl=3
nvram set pci/2/$slotidx/tssiposslope5g=1
nvram set pci/2/$slotidx/epagain5g=0
nvram set pci/2/$slotidx/pdgain5g=4
nvram set pci/2/$slotidx/tworangetssi5g=0
nvram set pci/2/$slotidx/papdcap5g=0
nvram set pci/2/$slotidx/gainctrlsph=0
nvram set pci/2/$slotidx/tempthresh=255
nvram set pci/2/$slotidx/tempoffset=255
nvram set pci/2/$slotidx/rawtempsense=0x1ff
nvram set pci/2/$slotidx/measpower=0x7f
nvram set pci/2/$slotidx/tempsense_slope=0xff
nvram set pci/2/$slotidx/tempcorrx=0x3f
nvram set pci/2/$slotidx/tempsense_option=0x3
nvram set pci/2/$slotidx/phycal_tempdelta=255
nvram set pci/2/$slotidx/temps_period=15
nvram set pci/2/$slotidx/temps_hysteresis=15
nvram set pci/2/$slotidx/measpower1=0x7f
nvram set pci/2/$slotidx/measpower2=0x7f
#nvram set pci/2/$slotidx/pdoffset40ma0=0
nvram set pci/2/$slotidx/pdoffset40ma0=4369
#nvram set pci/2/$slotidx/pdoffset40ma1=0
nvram set pci/2/$slotidx/pdoffset40ma1=4369
#nvram set pci/2/$slotidx/pdoffset40ma2=0
nvram set pci/2/$slotidx/pdoffset40ma2=4369
nvram set pci/2/$slotidx/pdoffset80ma0=0
nvram set pci/2/$slotidx/pdoffset80ma1=0
nvram set pci/2/$slotidx/pdoffset80ma2=0
nvram set pci/2/$slotidx/subband5gver=0x4
nvram set pci/2/$slotidx/subvid=0x14e4
nvram set pci/2/$slotidx/cckbw202gpo=0
nvram set pci/2/$slotidx/cckbw20ul2gpo=0
nvram set pci/2/$slotidx/mcsbw202gpo=0
nvram set pci/2/$slotidx/mcsbw402gpo=0
#nvram set pci/2/$slotidx/dot11agofdmhrbw202gpo=0
nvram set pci/2/$slotidx/dot11agofdmhrbw202g=0
nvram set pci/2/$slotidx/ofdmlrbw202gpo=0
#nvram set pci/2/$slotidx/mcsbw205glpo=4286018353
nvram set pci/2/$slotidx/mcsbw205glpo=3398914833
#nvram set pci/2/$slotidx/mcsbw405glpo=4286018353
nvram set pci/2/$slotidx/mcsbw405glpo=3398914833
#nvram set pci/2/$slotidx/mcsbw805glpo=4286018353
nvram set pci/2/$slotidx/mcsbw805glpo=3398914833
nvram set pci/2/$slotidx/mcsbw1605glpo=0
#nvram set pci/2/$slotidx/mcsbw205gmpo=4286018353
nvram set pci/2/$slotidx/mcsbw205gmpo=3398914833
#nvram set pci/2/$slotidx/mcsbw405gmpo=4286018353
nvram set pci/2/$slotidx/mcsbw405gmpo=3398914833
#nvram set pci/2/$slotidx/mcsbw805gmpo=4286018353
nvram set pci/2/$slotidx/mcsbw805gmpo=3398914833
nvram set pci/2/$slotidx/mcsbw1605gmpo=0
#nvram set pci/2/$slotidx/mcsbw205ghpo=4286018353
nvram set pci/2/$slotidx/mcsbw205ghpo=3398914833
#nvram set pci/2/$slotidx/mcsbw405ghpo=4286018353
nvram set pci/2/$slotidx/mcsbw405ghpo=3398914833
#nvram set pci/2/$slotidx/mcsbw805ghpo=4286018353
nvram set pci/2/$slotidx/mcsbw805ghpo=3398914833
nvram set pci/2/$slotidx/mcsbw1605ghpo=0
nvram set pci/2/$slotidx/mcslr5glpo=0
nvram set pci/2/$slotidx/mcslr5gmpo=0
nvram set pci/2/$slotidx/mcslr5ghpo=0
#nvram set pci/2/$slotidx/sb20in40hrrpo=0
nvram set pci/2/$slotidx/sb20in40hrpo=0
#nvram set pci/2/$slotidx/sb20in80and160hr5glpo=0
nvram set pci/2/$slotidx/sb20in80and160hr5gl=0
nvram set pci/2/$slotidx/sb40and80hr5glpo=0
#nvram set pci/2/$slotidx/sb20in80and160hr5gmpo=0
nvram set pci/2/$slotidx/sb20in80and160hr5gm=0
nvram set pci/2/$slotidx/sb40and80hr5gmpo=0
#nvram set pci/2/$slotidx/sb20in80and160hr5ghpo=0
nvram set pci/2/$slotidx/sb20in80and160hr5gh=0
nvram set pci/2/$slotidx/sb40and80hr5ghpo=0
nvram set pci/2/$slotidx/sb20in40lrpo=0
#nvram set pci/2/$slotidx/sb20in80and160lr5glpo=0
nvram set pci/2/$slotidx/sb20in80and160lr5gl=0
nvram set pci/2/$slotidx/sb40and80lr5glpo=0
#nvram set pci/2/$slotidx/sb20in80and160lr5gmpo=0
nvram set pci/2/$slotidx/sb20in80and160lr5gm=0
nvram set pci/2/$slotidx/sb40and80lr5gmpo=0
#nvram set pci/2/$slotidx/sb20in80and160lr5ghpo=0
nvram set pci/2/$slotidx/sb20in80and160lr5gh=0
nvram set pci/2/$slotidx/sb40and80lr5ghpo=0
nvram set pci/2/$slotidx/dot11agduphrpo=0
nvram set pci/2/$slotidx/dot11agduplrpo=0
nvram set pci/2/$slotidx/pcieingress_war=15
nvram set pci/2/$slotidx/sar2g=18
nvram set pci/2/$slotidx/sar5g=15
nvram set pci/2/$slotidx/noiselvl2ga0=31
nvram set pci/2/$slotidx/noiselvl2ga1=31
nvram set pci/2/$slotidx/noiselvl2ga2=31
#nvram set pci/2/$slotidx/noiselvl5gla0=31
#nvram set pci/2/$slotidx/noiselvl5gla1=31
#nvram set pci/2/$slotidx/noiselvl5gla2=31
#nvram set pci/2/$slotidx/noiselvl5gma0=31
#nvram set pci/2/$slotidx/noiselvl5gma1=31
#nvram set pci/2/$slotidx/noiselvl5gma2=31
#nvram set pci/2/$slotidx/noiselvl5gha0=31
#nvram set pci/2/$slotidx/noiselvl5gha1=31
#nvram set pci/2/$slotidx/noiselvl5gha2=31
#nvram set pci/2/$slotidx/noiselvl5gua0=31
#nvram set pci/2/$slotidx/noiselvl5gua1=31
#nvram set pci/2/$slotidx/noiselvl5gua2=31
nvram set pci/2/$slotidx/noiselvl5ga0=31,31,31,31
nvram set pci/2/$slotidx/noiselvl5ga1=31,31,31,31
nvram set pci/2/$slotidx/noiselvl5ga2=31,31,31,31
#nvram set pci/2/$slotidx/rxgainerr2g=0xffff
nvram set pci/2/$slotidx/rxgainerr2ga0=63
nvram set pci/2/$slotidx/rxgainerr2ga1=31
nvram set pci/2/$slotidx/rxgainerr2ga2=31
#nvram set pci/2/$slotidx/rxgainerr5g=0xffff,0xffff,0xffff,0xffff
nvram set pci/2/$slotidx/rxgainerr5ga0=63,63,63,63
nvram set pci/2/$slotidx/rxgainerr5ga1=31,31,31,31
nvram set pci/2/$slotidx/rxgainerr5ga2=31,31,31,31
nvram set pci/2/$slotidx/maxp2ga0=76
nvram set pci/2/$slotidx/pa2ga0=0xfe72,0x14c0,0xfac7
nvram set pci/2/$slotidx/rxgains5gmelnagaina0=2
nvram set pci/2/$slotidx/rxgains5gmtrisoa0=5
nvram set pci/2/$slotidx/rxgains5gmtrelnabypa0=1
nvram set pci/2/$slotidx/rxgains5ghelnagaina0=2
nvram set pci/2/$slotidx/rxgains5ghtrisoa0=5
nvram set pci/2/$slotidx/rxgains5ghtrelnabypa0=1
nvram set pci/2/$slotidx/rxgains2gelnagaina0=0
nvram set pci/2/$slotidx/rxgains2gtrisoa0=0
nvram set pci/2/$slotidx/rxgains2gtrelnabypa0=0
nvram set pci/2/$slotidx/rxgains5gelnagaina0=1
nvram set pci/2/$slotidx/rxgains5gtrisoa0=7
nvram set pci/2/$slotidx/rxgains5gtrelnabypa0=1
nvram set pci/2/$slotidx/maxp5ga0=92,92,92,92
nvram set pci/2/$slotidx/pa5ga0=0xff26,0x188e,0xfcf0,0xff2a,0x18ee,0xfcec,0xff21,0x18b4,0xfcec,0xff23,0x1930,0xfcdd
nvram set pci/2/$slotidx/maxp2ga1=76
nvram set pci/2/$slotidx/pa2ga1=0xfe80,0x1472,0xfabc
nvram set pci/2/$slotidx/rxgains5gmelnagaina1=2
nvram set pci/2/$slotidx/rxgains5gmtrisoa1=4
nvram set pci/2/$slotidx/rxgains5gmtrelnabypa1=1
nvram set pci/2/$slotidx/rxgains5ghelnagaina1=2
nvram set pci/2/$slotidx/rxgains5ghtrisoa1=4
nvram set pci/2/$slotidx/rxgains5ghtrelnabypa1=1
nvram set pci/2/$slotidx/rxgains2gelnagaina1=0
nvram set pci/2/$slotidx/rxgains2gtrisoa1=0
nvram set pci/2/$slotidx/rxgains2gtrelnabypa1=0
nvram set pci/2/$slotidx/rxgains5gelnagaina1=1
nvram set pci/2/$slotidx/rxgains5gtrisoa1=6
nvram set pci/2/$slotidx/rxgains5gtrelnabypa1=1
nvram set pci/2/$slotidx/maxp5ga1=92,92,92,92
nvram set pci/2/$slotidx/pa5ga1=0xff35,0x1a3c,0xfccc,0xff31,0x1a06,0xfccf,0xff2b,0x1a54,0xfcc5,0xff30,0x1ad5,0xfcb9
nvram set pci/2/$slotidx/maxp2ga2=76
nvram set pci/2/$slotidx/pa2ga2=0xfe82,0x14bf,0xfad9
nvram set pci/2/$slotidx/rxgains5gmelnagaina2=3
nvram set pci/2/$slotidx/rxgains5gmtrisoa2=4
nvram set pci/2/$slotidx/rxgains5gmtrelnabypa2=1
nvram set pci/2/$slotidx/rxgains5ghelnagaina2=3
nvram set pci/2/$slotidx/rxgains5ghtrisoa2=4
nvram set pci/2/$slotidx/rxgains5ghtrelnabypa2=1
nvram set pci/2/$slotidx/rxgains2gelnagaina2=0
nvram set pci/2/$slotidx/rxgains2gtrisoa2=0
nvram set pci/2/$slotidx/rxgains2gtrelnabypa2=0
nvram set pci/2/$slotidx/rxgains5gelnagaina2=1
nvram set pci/2/$slotidx/rxgains5gtrisoa2=5
nvram set pci/2/$slotidx/rxgains5gtrelnabypa2=1
nvram set pci/2/$slotidx/maxp5ga2=92,92,92,92
nvram set pci/2/$slotidx/pa5ga2=0xff2e,0x197b,0xfcd8,0xff2d,0x196e,0xfcdc,0xff30,0x1a7d,0xfcc2,0xff2e,0x1ac6,0xfcb4
done

#we only insert wifi modules in init. 
xmldbc -P /etc/services/WIFI/init_wifi_mod.php >> /var/init_wifi_mod.sh
chmod +x /var/init_wifi_mod.sh
/bin/sh /var/init_wifi_mod.sh

#initial wifi interfaces
service PHYINF.WIFI start
